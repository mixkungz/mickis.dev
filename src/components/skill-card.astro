---
interface Props {
  title: string;
  description?: string;
  proficiencyLevel: 1 | 2 | 3 | 4;
  proficiencyText: string;
  skills: string[];
  achievements?: string[];
  icon: string;
  size?: "small" | "large";
  orderClasses: string;
}

const {
  title,
  description,
  proficiencyLevel,
  proficiencyText,
  skills,
  achievements,
  icon,
  size = "small",
  orderClasses,
} = Astro.props;

const isLarge = size === "large";
const proficiencyBars = Math.min(proficiencyLevel, 4);
---

<div
  class={`group relative overflow-hidden rounded-3xl border border-border bg-card p-8 shadow-sm transition-all duration-300 ease-out hover:-translate-y-1 hover:border-level-${proficiencyLevel}/40 ${isLarge ? "md:col-span-2" : ""} ${orderClasses}`}
>
  <div
    class={`pointer-events-none absolute inset-x-0 top-0 h-px bg-level-${proficiencyLevel} opacity-80`}
  >
  </div>
  <div class={isLarge ? "relative z-10" : ""}>
    <div class="flex items-start justify-between gap-6">
      <div>
        <h3 class={`${isLarge ? "mt-4 text-3xl" : "text-xl"} font-bold text-foreground`}>
          {title}
        </h3>
      </div>
      <svg
        class={`${isLarge ? "h-10 w-10" : "h-6 w-6"} text-level-${proficiencyLevel} ${isLarge ? "opacity-70" : "flex-shrink-0"}`}
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <Fragment set:html={icon} />
      </svg>
    </div>

    {isLarge && (
      <p class="mt-4 max-w-xl text-muted-foreground">
        {description}
      </p>
    )}

    <div class={isLarge ? "mt-8 space-y-6" : "mt-6"}>
      <div>
        <div class={isLarge ? "mb-2 flex items-center justify-between text-sm" : "mb-3 flex gap-2"}>
          {isLarge ? (
            <span class="font-medium text-foreground"
              >Proficiency: <span class={`text-level-${proficiencyLevel}`}
                >{proficiencyText}</span
              ></span
            >
          ) : (
            <div class="flex gap-2 w-full">
              {Array.from({ length: 4 }).map((_, i) => (
                <div
                  class={`h-2 flex-1 rounded-full ${
                    i < proficiencyBars
                      ? `bg-level-${proficiencyLevel}`
                      : "bg-muted"
                  }`}
                >
                </div>
              ))}
            </div>
          )}
        </div>
        {isLarge && (
          <div class="flex gap-3">
            {Array.from({ length: 4 }).map((_, i) => (
              <div
                class={`h-2 flex-1 rounded-full ${
                  i < proficiencyBars
                    ? `bg-level-${proficiencyLevel} shadow-level-${proficiencyLevel}`
                    : "bg-muted"
                }`}
              >
              </div>
            ))}
          </div>
        )}
      </div>

      {!isLarge && (
        <div class="mb-2 flex items-center justify-between text-sm">
          <span
            class={`text-xs font-bold uppercase tracking-widest text-level-${proficiencyLevel}`}
          >
            {proficiencyText}
          </span>
        </div>
      )}

      <div class={isLarge ? "flex flex-wrap gap-3" : "flex flex-wrap gap-2"}>
        {skills.map((skill) => (
          <span
            class={isLarge ? "rounded-xl border border-border bg-muted/40 px-4 py-2 text-sm font-normal uppercase text-foreground" : "rounded-full border border-border bg-muted/40 px-3 py-1 text-[10px] font-semibold uppercase text-foreground"}
          >
            {skill}
          </span>
        ))}
      </div>

      {achievements && isLarge && (
        <div class="space-y-3">
          <p class="text-xs font-bold uppercase tracking-widest text-muted-foreground">
            Key achievements
          </p>
          <ul class="space-y-2 text-sm text-foreground">
            {achievements.map((achievement, i) => (
              <li class="flex gap-3">
                <span class={`text-level-${proficiencyLevel}`}>{String(i + 1).padStart(2, "0")}.</span>
                <span>{achievement}</span>
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  </div>
</div>
